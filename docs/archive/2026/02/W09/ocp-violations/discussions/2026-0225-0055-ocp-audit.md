# OCP 위반 전수 조사 Discussion

## Journey

**🧑 사용자**: if/switch 검색으로 OCP 위반 전수 조사해줘

**🤖 AI**: 22건 발견. 🔴 위반 9건, 🟡 주의 7건, 🟢 정당 6건으로 분류.

---

**🧑 사용자**: 🔴 9건 다 수정해야겠지? 검토해봐

**🤖 AI**: Toulmin 분석 결과 9건 중 3건만 수정 대상 제안.
- primitives.ts: 닫힌 union → exhaustiveness 이점
- Inspector: "개발도구는 저빈도" → ROI 부적합
- BuilderListPage/Sidebar: 닫힌 도메인

---

**🧑 사용자**: 개발도구는 고빈도 코드야. OS를 만드는게 목적이라는거 잊지마

**🤖 AI**: 수정. rules #10 "이 OS 위에서 이 OS를 만든다" → Inspector는 1급 산출물.
Inspector 2건을 수정 대상으로 승격. 5건 확정.

---

**🧑 사용자**: 주의 쪽은 어때?

**🤖 AI**: 7건 전부 OS 물리법칙의 닫힌 분기 (dismiss, entry, select, expand).
switch가 exhaustiveness 게이트로 기능 → 등가 교환 → 수정 불필요.

---

**🧑 사용자**: 5건만 가자 → /project

## Conclusion

| Toulmin | 내용 |
|---------|------|
| **🎯 Claim** | OCP 위반 22건 중 **5건만 수정 대상**. 블록 레지스트리 통합(#3,#4), Inspector 레지스트리(#5,#6), QuickPick OS 파이프라인 전환(#9) |
| **📊 Data** | switch/if 전수 검색 22건. 닫힌 union 12건, 복제 레지스트리 2건, OS 파이프라인 우회 1건, 하드코딩 레지스트리 2건 |
| **🔗 Warrant** | W1. 닫힌 union switch는 exhaustiveness check 이점 / W2. 복제 레지스트리는 rules #11 위반 / W3. e.key 직접 분기는 OS 파이프라인 우회 / W4. 등가 교환 리팩토링 금지 (검증#8) / W5. Inspector는 OS 1급 산출물 (rules #10) / W6. OS 프로토콜(dismiss, entry, select, expand)은 닫힌 물리법칙 |
| **📚 Backing** | Open-Closed Principle (Robert C. Martin), Exhaustive Pattern Matching, Registry Pattern |
| **⚖️ Qualifier** | Complicated — 분석으로 답이 좁혀짐 |
| **⚡ Rebuttal** | primitives.ts PropertyType이 향후 열린 도메인이 되면 재검토 필요 |
| **❓ Open Gap** | BuilderListPage/Sidebar가 SaaS 확장 시 열린 도메인이 될 가능성 |
