# OS ì½”ë“œ êµ¬ì¡° ê²€ìˆ˜ ë³´ê³ ì„œ

**ì‘ì„±ì¼**: 2026-02-04  
**ëŒ€ìƒ**: `src/os/` ë””ë ‰í† ë¦¬ ì „ì²´

---

## 1. ê°œìš” (Overview)

ë³¸ ë³´ê³ ì„œëŠ” `interactive-os` í”„ë¡œì íŠ¸ì˜ í•µì‹¬ì¸ **Antigravity OS** ì½”ë“œ êµ¬ì¡°ë¥¼ ê²€ìˆ˜í•œ ê²°ê³¼ì…ë‹ˆë‹¤. OS ëª¨ë“ˆì€ í‚¤ë³´ë“œ/ë§ˆìš°ìŠ¤ ê¸°ë°˜ì˜ ìƒí˜¸ì‘ìš© ìš´ì˜ ì²´ì œë¡œ, í¬ì»¤ìŠ¤ ê´€ë¦¬, ì»¤ë§¨ë“œ ì‹œìŠ¤í…œ, ë„¤ë¹„ê²Œì´ì…˜ ì—”ì§„ì„ ì œê³µí•©ë‹ˆë‹¤.

### ë””ë ‰í† ë¦¬ êµ¬ì¡° ìš”ì•½

```
src/os/
â”œâ”€â”€ core/          # í•µì‹¬ ì‹œìŠ¤í…œ ë¡œì§
â”‚   â”œâ”€â”€ AntigravityOS.tsx      # OS ì§„ì…ì 
â”‚   â”œâ”€â”€ context.tsx            # ê¸€ë¡œë²Œ ì»¨í…ìŠ¤íŠ¸ Provider
â”‚   â”œâ”€â”€ focus.ts               # FocusStore (Zustand)
â”‚   â”œâ”€â”€ navigation.ts          # ë„¤ë¹„ê²Œì´ì…˜ ì—”ì§„
â”‚   â”œâ”€â”€ application/           # ì• í”Œë¦¬ì¼€ì´ì…˜ ì •ì˜
â”‚   â”œâ”€â”€ command/               # ì»¤ë§¨ë“œ ì‹œìŠ¤í…œ
â”‚   â”œâ”€â”€ input/                 # ì…ë ¥ ì—”ì§„
â”‚   â”œâ”€â”€ logic/                 # ì¡°ê±´ í‰ê°€ ì‹œìŠ¤í…œ
â”‚   â””â”€â”€ persistence/           # ì˜ì†ì„± ì–´ëŒ‘í„°
â”œâ”€â”€ debug/         # ë””ë²„ê¹… ë° ê´€ì°°ë„êµ¬
â”‚   â”œâ”€â”€ Inspector.tsx          # ë©”ì¸ Inspector UI
â”‚   â”œâ”€â”€ logger.ts              # ë¡œê¹… ì‹œìŠ¤í…œ
â”‚   â”œâ”€â”€ inputTelemetry.ts      # ì…ë ¥ í…”ë ˆë©”íŠ¸ë¦¬
â”‚   â””â”€â”€ inspector/             # Inspector ì„œë¸Œ ì»´í¬ë„ŒíŠ¸
â””â”€â”€ ui/            # UI í”„ë¦¬ë¯¸í‹°ë¸Œ
    â”œâ”€â”€ App.tsx                # ì• í”Œë¦¬ì¼€ì´ì…˜ ì…¸
    â”œâ”€â”€ Zone.tsx               # ê´€í•  ì˜ì—­ ì»´í¬ë„ŒíŠ¸
    â”œâ”€â”€ Item.tsx               # í¬ì»¤ìŠ¤ ëŒ€ìƒ ì•„ì´í…œ
    â”œâ”€â”€ Field.tsx              # ContentEditable ì…ë ¥
    â”œâ”€â”€ Trigger.tsx            # ë²„íŠ¼ íŠ¸ë¦¬ê±°
    â”œâ”€â”€ Kbd.tsx                # í‚¤ë³´ë“œ íŒíŠ¸ í‘œì‹œ
    â””â”€â”€ index.ts               # Export ëª¨ë“ˆ
```

---

## 2. ë¶„ì„ (Analysis)

### 2.1 ì•„í‚¤í…ì²˜ íŒ¨í„´

#### âœ… **ê°•ì : ë‹¨ì¼ ì…ë ¥ ì—”ì§„ (InputEngine)**
- ëª¨ë“  í‚¤ë³´ë“œ/ë§ˆìš°ìŠ¤ ì…ë ¥ì´ `InputEngine.tsx`ì—ì„œ ì¤‘ì•™ ì²˜ë¦¬ë¨
- Zoneë³„ ë¶„ì‚° ì²˜ë¦¬ ëŒ€ì‹  ê¸€ë¡œë²Œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¡œ í†µí•©
- ë²„ë¸”ë§ ê²½ë¡œ ìˆœíšŒë¥¼ í†µí•œ ê³„ì¸µì  ì»¤ë§¨ë“œ í•´ì„

```typescript
// InputEngine.tsx - ë²„ë¸”ë§ ë ˆì´ì–´
const bubblePath = focusPath.length > 0 
  ? [...focusPath].reverse() 
  : (currentActiveZoneId ? [currentActiveZoneId] : []);
bubblePath.push("global"); // ìµœì¢… í´ë°±
```

#### âœ… **ê°•ì : Active Registration ì‹œìŠ¤í…œ**
- `Item`ê³¼ `Zone`ì´ ë§ˆìš´íŠ¸ ì‹œ ìê°€ ë“±ë¡ (Self-Registration)
- DOM ì„¼ì‹± ëŒ€ì‹  React ë¼ì´í”„ì‚¬ì´í´ ê¸°ë°˜ì˜ ê²°ì •ë¡ ì  ë“±ë¡
- `FocusStore.addItem` / `removeItem`ìœ¼ë¡œ ì•„ì´í…œ ê´€ë¦¬

```typescript
// Item.tsx - Active Registration
useLayoutEffect(() => {
  if (zoneId && zoneId !== "unknown") {
    addItem(zoneId, stringId);
    return () => removeItem(zoneId, stringId);
  }
}, [zoneId, stringId, addItem, removeItem]);
```

#### âœ… **ê°•ì : ì„ ì–¸ì  Zone ì»´í¬ë„ŒíŠ¸**
- `Zone`ì€ ìˆœìˆ˜ ì„ ì–¸ì  (ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì—†ìŒ)
- ë©”íƒ€ë°ì´í„° ë“±ë¡ê³¼ DOM ë§ˆì»¤ ì œê³µë§Œ ë‹´ë‹¹
- ëª¨ë“  ìƒí˜¸ì‘ìš©ì€ ê¸€ë¡œë²Œ InputEngineì´ ì²˜ë¦¬

### 2.2 í•µì‹¬ ëª¨ë“ˆ ë¶„ì„

| ëª¨ë“ˆ | íŒŒì¼ ìˆ˜ | ë¼ì¸ | ì—­í•  | ìƒíƒœ |
|------|--------|------|------|------|
| `command/` | 7 | ~600 | ì»¤ë§¨ë“œ ì •ì˜/ë ˆì§€ìŠ¤íŠ¸ë¦¬/ìŠ¤í† ì–´ | âœ… ê²¬ê³  |
| `input/` | 2 | ~200 | ì…ë ¥ ì—”ì§„/í‚¤ë°”ì¸ë”© | âœ… ê²¬ê³  |
| `logic/` | 3 | ~100 | ì¡°ê±´ì‹ í‰ê°€ (`when` ì ˆ) | âœ… ê°„ê²° |
| `focus.ts` | 1 | 248 | Zustand í¬ì»¤ìŠ¤ ìŠ¤í† ì–´ | âœ… í•µì‹¬ |
| `navigation.ts` | 1 | 268 | ë„¤ë¹„ê²Œì´ì…˜ ì „ëµ ì—”ì§„ | âœ… ê²¬ê³  |
| `ui/` | 9 | ~700 | UI í”„ë¦¬ë¯¸í‹°ë¸Œ | âš ï¸ ì¼ë¶€ ë³µì¡ |

### 2.3 ì£¼ìš” ì´ìŠˆ ë° ê°œì„ ì 

#### âš ï¸ **ì´ìŠˆ 1: Field ì»´í¬ë„ŒíŠ¸ ë³µì¡ë„**
- **íŒŒì¼**: `src/os/ui/Field.tsx` (319 ë¼ì¸)
- **ë¬¸ì œì **: ContentEditable ì²˜ë¦¬, IME ì§€ì›, ì»¤ì„œ ì»¨í…ìŠ¤íŠ¸ ë“± ë‹¤ì¤‘ ì±…ì„
- **ê¶Œì¥**: ë¡œì§ì„ ì»¤ìŠ¤í…€ í›…ìœ¼ë¡œ ë¶„ë¦¬ (`useContentEditable.ts`)

#### âš ï¸ **ì´ìŠˆ 2: Navigation í•¨ìˆ˜ ë‚´ í•˜ë“œì½”ë”©ëœ ë¡œì§**
- **íŒŒì¼**: `src/os/core/navigation.ts`
- **ë¬¸ì œì **: `findNextSpatialTarget`ì´ 100ì¤„ ì´ìƒì˜ ë³µì¡í•œ ë¬¼ë¦¬ ê³„ì‚° í¬í•¨
- **ê¶Œì¥**: ì „ëµë³„ ëª¨ë“ˆ ë¶„ë¦¬ (`strategies/spatial.ts`, `strategies/roving.ts`)

#### âš ï¸ **ì´ìŠˆ 3: osRegistry ë‚´ OS_NAVIGATE ë³µì¡ë„**
- **íŒŒì¼**: `src/os/core/command/osRegistry.ts`
- **ë¬¸ì œì **: `Navigate.run` í•¨ìˆ˜ê°€ ~130ì¤„ë¡œ ê³¼ë„í•˜ê²Œ ë³µì¡
- **ê¶Œì¥**: ì¤‘ì²© Zone í•´ì„ ë¡œì§ì„ ë³„ë„ ìœ í‹¸ë¡œ ì¶”ì¶œ

```typescript
// í˜„ì¬ osRegistry.tsì˜ Navigate.run (ë¬¸ì œì )
run(state, payload: { direction: ... }) {
  // 130+ lines of complex navigation logic
  // - Zone hierarchy resolution
  // - Strategy dispatch  
  // - Focus execution
}
```

#### âš ï¸ **ì´ìŠˆ 4: Inspector ìŠ¤íƒ€ì¼ í•˜ë“œì½”ë”©**
- **íŒŒì¼**: `src/os/debug/Inspector.tsx`
- **ë¬¸ì œì **: ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ê³¼ Tailwind í´ë˜ìŠ¤ í˜¼ìš©
- **ê¶Œì¥**: ì¼ê´€ëœ ìŠ¤íƒ€ì¼ë§ ì „ëµ ì±„íƒ

### 2.4 íƒ€ì… ì‹œìŠ¤í…œ í‰ê°€

#### âœ… ê°•ì 
- `CommandDefinition<S, P, K>` ì œë„¤ë¦­ìœ¼ë¡œ íƒ€ì… ì•ˆì „ ì»¤ë§¨ë“œ íŒ©í† ë¦¬
- `ZoneMetadata` ì¸í„°í˜ì´ìŠ¤ë¡œ Zone ì„¤ì • ëª…ì‹œí™”
- `FocusObject` íƒ€ì…ìœ¼ë¡œ í¬ì»¤ìŠ¤ ìƒíƒœ ëª…í™•í™”

#### âš ï¸ ê°œì„ ì 
- `store.tsx`ì—ì„œ `any` íƒ€ì… ë‚¨ìš© (7ê°œì†Œ)
- `useCommandCenter.ts`ì—ì„œ `(state as any)` íŒ¨í„´ ë‹¤ìˆ˜

### 2.5 ì˜ì¡´ì„± íë¦„

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ AntigravityOSâ”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â–¼            â–¼            â–¼
        InputEngine    FocusStore   CommandContext
              â”‚            â”‚            â”‚
              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ osRegistry   â”‚
              â”‚ (OS Commands)â”‚
              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ navigation.tsâ”‚
              â”‚ (3 strategies)â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. ê²°ë¡  ë° ì œì•ˆ (Conclusion & Proposal)

### 3.1 ì¢…í•© í‰ê°€

| ì¹´í…Œê³ ë¦¬ | ì ìˆ˜ | ë¹„ê³  |
|----------|------|------|
| ì•„í‚¤í…ì²˜ | â­â­â­â­â­ | ë‹¨ì¼ ì…ë ¥ ì—”ì§„, Active Registration ìš°ìˆ˜ |
| ì½”ë“œ í’ˆì§ˆ | â­â­â­â­ | ì¼ë¶€ ë³µì¡í•œ í•¨ìˆ˜ ì¡´ì¬ |
| íƒ€ì… ì•ˆì „ì„± | â­â­â­â­ | ì œë„¤ë¦­ í™œìš© ìš°ìˆ˜, any ë‚¨ìš© ê°œì„  í•„ìš” |
| ëª¨ë“ˆí™” | â­â­â­â­ | navigation ì „ëµ ë¶„ë¦¬ ê¶Œì¥ |
| ê´€ì°°ì„± | â­â­â­â­â­ | Inspector, Logger ì‹œìŠ¤í…œ ìš°ìˆ˜ |

### 3.2 ìš°ì„ ìˆœìœ„ë³„ ì œì•ˆ ì‚¬í•­

#### ğŸ”´ **ë†’ìŒ (High Priority)**
1. **Field.tsx ë¦¬íŒ©í† ë§**: 319ì¤„ â†’ ì»¤ìŠ¤í…€ í›… ë¶„ë¦¬ë¡œ 200ì¤„ ì´í•˜ ëª©í‘œ
2. **osRegistry Navigate í•¨ìˆ˜ ë¶„ë¦¬**: ë„¤ë¹„ê²Œì´ì…˜ ì‹¤í–‰ ë¡œì§ì„ `navigation.ts`ë¡œ ì´ë™

#### ğŸŸ¡ **ì¤‘ê°„ (Medium Priority)**
3. **Navigation ì „ëµ ëª¨ë“ˆí™”**: `core/navigation/` ë””ë ‰í† ë¦¬ ìƒì„±
   - `strategies/spatial.ts`
   - `strategies/roving.ts`
   - `strategies/grid.ts`
4. **íƒ€ì… any ì œê±°**: store.tsxì™€ useCommandCenter.tsì˜ `any` ì œê±°

#### ğŸŸ¢ **ë‚®ìŒ (Low Priority)**
5. **Inspector ìŠ¤íƒ€ì¼ ì •ë¦¬**: CSS ëª¨ë“ˆ ë˜ëŠ” ì¼ê´€ëœ Tailwind ì ìš©
6. **ì£¼ì„ í†µì¼**: JSDoc ìŠ¤íƒ€ì¼ë¡œ API ë¬¸ì„œí™”

### 3.3 ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ ê¶Œì¥

í˜„ì¬ ì½”ë“œë² ì´ìŠ¤ëŠ” ë¬¸ì„œí™”ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤. ë‹¤ìŒ ë¬¸ì„œë¥¼ `docs/` ë””ë ‰í† ë¦¬ì— ì¶”ê°€í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤:

- `docs/architecture/os-overview.md` - OS ì „ì²´ ì•„í‚¤í…ì²˜
- `docs/architecture/focus-flow.md` - í¬ì»¤ìŠ¤ íë¦„ë„
- `docs/architecture/command-lifecycle.md` - ì»¤ë§¨ë“œ ì‹¤í–‰ ìƒëª…ì£¼ê¸°

---

## 4. íŒŒì¼ë³„ ìƒì„¸ í˜„í™©

### 4.1 Core ëª¨ë“ˆ (26ê°œ íŒŒì¼, ~2,000 ë¼ì¸)

| íŒŒì¼ | ë¼ì¸ | ë³µì¡ë„ | ìƒíƒœ |
|------|------|--------|------|
| `focus.ts` | 248 | ì¤‘ | âœ… OK |
| `navigation.ts` | 268 | ë†’ìŒ | âš ï¸ ë¶„ë¦¬ ê¶Œì¥ |
| `command/store.tsx` | 317 | ë†’ìŒ | âš ï¸ any ì œê±° í•„ìš” |
| `command/osRegistry.ts` | 248 | ë†’ìŒ | âš ï¸ ë¦¬íŒ©í† ë§ í•„ìš” |
| `command/definition.ts` | 67 | ë‚®ìŒ | âœ… OK |
| `input/InputEngine.tsx` | 155 | ì¤‘ | âœ… OK |
| `input/keybinding.ts` | 77 | ë‚®ìŒ | âœ… OK |
| `logic/evaluator.ts` | 28 | ë‚®ìŒ | âœ… OK |
| `context.tsx` | 80 | ë‚®ìŒ | âœ… OK |

### 4.2 UI í”„ë¦¬ë¯¸í‹°ë¸Œ (9ê°œ íŒŒì¼, ~700 ë¼ì¸)

| íŒŒì¼ | ë¼ì¸ | ë³µì¡ë„ | ìƒíƒœ |
|------|------|--------|------|
| `Field.tsx` | 319 | ë§¤ìš° ë†’ìŒ | ğŸ”´ ë¦¬íŒ©í† ë§ í•„ìš” |
| `Zone.tsx` | 164 | ì¤‘ | âœ… OK |
| `Item.tsx` | 144 | ì¤‘ | âœ… OK |
| `App.tsx` | ~150 | ì¤‘ | âœ… OK |
| `Trigger.tsx` | 49 | ë‚®ìŒ | âœ… OK |
| `Kbd.tsx` | 37 | ë‚®ìŒ | âœ… OK |

### 4.3 Debug ëª¨ë“ˆ (11ê°œ íŒŒì¼, ~600 ë¼ì¸)

| íŒŒì¼ | ë¼ì¸ | ë³µì¡ë„ | ìƒíƒœ |
|------|------|--------|------|
| `Inspector.tsx` | 203 | ì¤‘ | âš ï¸ ìŠ¤íƒ€ì¼ ì •ë¦¬ í•„ìš” |
| `logger.ts` | 78 | ë‚®ìŒ | âœ… OK |
| `inspector/RegistryMonitor.tsx` | ~240 | ì¤‘ | âœ… OK |
| `inspector/EventStream.tsx` | ~70 | ë‚®ìŒ | âœ… OK |

---

*ë³´ê³ ì„œ ì‘ì„±: Antigravity Agent*  
*ê²€ìˆ˜ ë²”ìœ„: src/os/ (ì´ 46ê°œ íŒŒì¼, ~3,500 ë¼ì¸)*
