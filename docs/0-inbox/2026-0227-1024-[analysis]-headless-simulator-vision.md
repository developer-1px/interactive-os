# Headless Simulator: Vitestì—ì„œ Playwright ìˆ˜ì¤€ ê²€ì¦ ë‹¬ì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ì›ë¬¸** | focus e2e í…ŒìŠ¤íŠ¸ ì „ë¶€ ë‹¤ ê¹¨ì§€ê³  ìˆì–´. í•µì‹¬ ìŸì ì€ e2eì—ì„œëŠ” ê²€ì¦ì´ ê°€ëŠ¥í•œë° vitestì—ì„œëŠ” ê²€ì¦í•˜ì§€ ëª»í•œë‹¤. vitestì—ì„œ playwrightì— ì¤€í•˜ëŠ” ì‹œë®¬ë ˆì´í„°ë¥¼ ë§Œë“¤ê³  DOM â†’ VDOMìœ¼ë¡œ ì¹˜í™˜. |
| **ë‚´(AI)ê°€ ì¶”ì •í•œ ì˜ë„** | |
| ê²½ìœ„ | headless-item-discovery ë¦¬íŒ©í† ë§ í›„ Playwright e2e 25/29 ì‹¤íŒ¨ ë°œê²¬. VitestëŠ” "0 regression" íŒì • (ê±°ì§“ GREEN). |
| í‘œë©´ | ê¹¨ì§„ e2eë¥¼ ìˆ˜ì •í•˜ê³  ì‹¶ë‹¤. |
| ì˜ë„ | e2e ì—†ì´, vitestë§Œìœ¼ë¡œ FEë¥¼ ì‹ ë¢°í•  ìˆ˜ ìˆê²Œ ê²€ì¦í•˜ëŠ” OS ì¸í”„ë¼ë¥¼ êµ¬ì¶•í•˜ê³  ì‹¶ë‹¤. LLMì´ ììœ¨ì ìœ¼ë¡œ ê°œë°œ + ê²€ì¦í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì˜ ì™„ì„±. |
| **ë‚ ì§œ** | 2026-02-27 |
| **ìƒíƒœ** | ğŸ†• í”„ë¡œì íŠ¸ ìƒì„±ë¨ â†’ headless-simulator |

## 1. ê°œìš”

headless-item-discovery ë¦¬íŒ©í† ë§(Phase 1/2 push model) í›„, Vitest ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëŠ” "regression 0"ì„ ë³´ê³ í–ˆì§€ë§Œ Playwright e2eëŠ” 25/29 ì‹¤íŒ¨. **createOsPage ê¸°ë°˜ headless í…ŒìŠ¤íŠ¸ê°€ FocusGroupì˜ React ë¼ì´í”„ì‚¬ì´í´(useMemo/useLayoutEffect ìƒí˜¸ì‘ìš©)ì„ ìš°íšŒ**í•˜ê¸° ë•Œë¬¸ì—, ì»´í¬ë„ŒíŠ¸ ë“±ë¡ ë¶ˆì¼ì¹˜ ê°™ì€ ë²„ê·¸ë¥¼ ì›ë¦¬ì ìœ¼ë¡œ ê°ì§€ ë¶ˆê°€.

ì´ê²ƒì€ OSì˜ í•µì‹¬ ëª©ì  â€” "headlessì—ì„œ OS ë™ì‘ì„ ì™„ì „ ê²€ì¦" â€” ì´ ì•„ì§ ë‹¬ì„±ë˜ì§€ ì•Šì•˜ìŒì„ ì¦ëª…í•œë‹¤.

## 2. ë¶„ì„

### ê±°ì§“ GREENì˜ ë©”ì»¤ë‹ˆì¦˜

```
createOsPage ê²½ë¡œ:    ìˆ˜ë™ register â†’ getItems ì§ì ‘ ì„¤ì • â†’ ì»¤ë§¨ë“œ í…ŒìŠ¤íŠ¸
ì‹¤ì œ ë¸Œë¼ìš°ì € ê²½ë¡œ:   FocusGroup mount â†’ Phase 1(useMemo) â†’ Phase 2(useLayoutEffect) â†’ ìƒí˜¸ì‘ìš©
```

Phase 1ì´ ì¬ì‹¤í–‰(config ë³€ê²½)ë  ë•Œ Phase 2ì˜ getItems ë“±ë¡ì„ ë®ì–´ì“°ëŠ” ë²„ê·¸ â†’ DOM_ITEMS ë¹ˆ ë°°ì—´ â†’ OS_NAVIGATE skip â†’ aria-current ë¯¸ì„¤ì •. **ì´ ì „ì²´ ì²´ì¸ì€ React ì»´í¬ë„ŒíŠ¸ ë¼ì´í”„ì‚¬ì´í´ì—ì„œë§Œ ë°œìƒí•˜ë©°, createOsPageì—ì„œëŠ” ì¬í˜„ ë¶ˆê°€.**

### ê²€ì¦ ì¶• ê°­ ë¶„ì„

| ì¶• | Vitest(createOsPage) | Playwright(e2e) |
|----|---------------------|-----------------|
| ì»¤ë§¨ë“œ ë¡œì§ (state ë³€í™˜) | âœ… | âœ… |
| ì»´í¬ë„ŒíŠ¸ ë“±ë¡ ë¼ì´í”„ì‚¬ì´í´ | âŒ | âœ… |
| attrs íˆ¬ì˜ (aria-*, tabIndex) | ë¶€ë¶„ì  (page.attrs) | âœ… |
| DOM focus/scroll ë¬¼ë¦¬ íš¨ê³¼ | âŒ | âœ… |

### í•´ê²° ë°©í–¥ (Complex â€” How ë¯¸í™•ì •)

**ëª©í‘œ**: DOM â†’ OS VDOM ì¹˜í™˜. OSê°€ State â†’ Projection(attrs)ì„ ìˆœìˆ˜ ê³„ì‚°í•˜ë©´, React ì—†ì´ë„ íˆ¬ì˜ ê²€ì¦ ê°€ëŠ¥.

**í•µì‹¬ ì „ì œ**: FocusItemì˜ aria-current, tabIndex, aria-selected ê³„ì‚°ì€ ì´ë¯¸ ìˆœìˆ˜ í•¨ìˆ˜ì— ê°€ê¹ë‹¤. ì´ê²ƒì„ OS ë ˆì´ì–´ë¡œ ì¶”ì¶œí•˜ë©´ headless ê²€ì¦ ê°€ëŠ¥.

## 3. ì œì•ˆ

1. **ì¦‰ì‹œ**: Phase 1/2 ë¼ì´í”„ì‚¬ì´í´ ë¶ˆì¼ì¹˜ ìˆ˜ì • â†’ e2e GREEN ë³µêµ¬ (T3)
2. **ë‹¨ê¸°**: ê¹¨ì§„ e2e 25ê°œë¥¼ ë¶„ë¥˜í•˜ì—¬ ì–´ë–¤ ì¢…ë¥˜ì˜ ê²€ì¦ì´ í•„ìš”í•œì§€ ë¶„ì„ (T1)
3. **ì¤‘ê¸°**: createOsPage.attrs()ì™€ FocusItem attrs ê³„ì‚°ì˜ ê°­ ë¶„ì„ (T2)
4. **ì¥ê¸°**: OS Projection ê³„ì‚°ê¸° êµ¬í˜„ â†’ vitestì—ì„œ Playwright ìˆ˜ì¤€ ê²€ì¦ ë‹¬ì„±

## 4. Cynefin ë„ë©”ì¸ íŒì •

ğŸ”´ **Complex** â€” DOMê³¼ React ë¼ì´í”„ì‚¬ì´í´ì˜ ìƒí˜¸ì‘ìš©ì„ ìˆœìˆ˜ í•¨ìˆ˜ë¡œ ë¶„ë¦¬í•˜ëŠ” ê²ƒì€ ê¸°ì¡´ ì„ ë¡€ê°€ ì—†ëŠ” ì„¤ê³„ ê²°ì •. Probe(e2e ë¶„ë¥˜, attrs ê°­ ë¶„ì„) â†’ Sense(íŒ¨í„´ ë°œê²¬) â†’ Respond(ì„¤ê³„ í™•ì •) ìˆœì„œ.

## 5. ì¸ì‹ í•œê³„

- Phase 1/2 ë¶ˆì¼ì¹˜ê°€ ìœ ì¼í•œ ì›ì¸ì¸ì§€ ë¯¸í™•ì¸. 25ê°œ e2e ì‹¤íŒ¨ ì¤‘ ë‹¤ë¥¸ ì›ì¸ì´ ìˆì„ ìˆ˜ ìˆìŒ.
- OS VDOMì´ ì‹¤í˜„ ê°€ëŠ¥í•œì§€ëŠ” FocusItem attrs ë¡œì§ì˜ ë³µì¡ë„ì— ì˜ì¡´. role ì¶”ë¡ , expandable ê²°ì • ë“± ì•±-OS ê²½ê³„ì˜ ì •ë³´ê°€ í•„ìš”í•œ ë¶€ë¶„ì´ ìˆì„ ìˆ˜ ìˆìŒ.
- testing-library ì—†ì´ React ë¼ì´í”„ì‚¬ì´í´ì„ ì–´ë–»ê²Œ ê²€ì¦í•  ê²ƒì¸ì§€ëŠ” ë¯¸í•´ê²°.

## 6. ì—´ë¦° ì§ˆë¬¸

1. OS VDOMì˜ êµ¬ì²´ì  í˜•íƒœëŠ” ë¬´ì—‡ì¸ê°€? (ê³„ì¸µ êµ¬ì¡°? í”Œë« ë§µ?)
2. FocusItemì˜ attrs ì¤‘ ì•±ì´ ê²°ì •í•˜ëŠ” ë¶€ë¶„(role, className)ê³¼ OSê°€ ê²°ì •í•˜ëŠ” ë¶€ë¶„(aria-current, tabIndex)ì˜ ê²½ê³„ëŠ”?
3. createOsPageì™€ createPageì˜ ê´€ê³„ë¥¼ ì–´ë–»ê²Œ ì¬ì •ì˜í•  ê²ƒì¸ê°€?
4. Playwright e2eì˜ ìµœì¢… ì—­í• ì€ "VDOMâ†’DOM ë™í˜•ì„± smoke test"ë¡œ ì¶•ì†Œë˜ëŠ” ê²ƒì´ ë§ëŠ”ê°€?

---

> **vitestì—ì„œ Playwright ìˆ˜ì¤€ ê²€ì¦ì„ ë‹¬ì„±í•˜ëŠ” ê²ƒì´ OSì˜ í•µì‹¬ ë¯¸ì…˜. í˜„ì¬ createOsPageëŠ” ì»¤ë§¨ë“œ ì¶•ë§Œ ê²€ì¦í•˜ê³  íˆ¬ì˜ ì¶•ì€ ë¯¸ê²€ì¦ (ê±°ì§“ GREEN).**
> **í•´ê²° ë°©í–¥: DOM â†’ OS VDOM ì¹˜í™˜. State â†’ Projectionì„ ìˆœìˆ˜ í•¨ìˆ˜ë¡œ ê³„ì‚°í•˜ë©´ React ì—†ì´ attrs ê²€ì¦ ê°€ëŠ¥.**
> **ì¥ê¸° Heavy í”„ë¡œì íŠ¸ë¡œ `headless-simulator` ìƒì„±. ì²« ë‹¨ê³„ëŠ” ê¹¨ì§„ e2e ë¶„ë¥˜ + Phase 1/2 ìˆ˜ì •.**
