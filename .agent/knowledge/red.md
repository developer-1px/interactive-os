# REDBOOK — Red 테스트 지식베이스

> `/red` 시작 시 읽는다. 종료 시 새 지식이 있으면 갱신한다.
> 좋은 헤드리스 테스트 패턴과 함정을 축적한다.

---

## 1. 알려진 좋은 패턴

| 패턴 | 설명 | 발견일 |
|------|------|--------|
| **헤드리스 테스트** | OS 상태 함수를 직접 호출하여 검증. DOM/이벤트 없음 | 2026-02-25 |
| **DT행 → 테스트 1:1** | DT 한 행 = 테스트 케이스 하나. 행 번호를 테스트 describe에 명시 | 2026-02-25 |
| **순수 함수 우선** | `createXxxState()` → 변환 함수 → 결과 단언. 상태 불변성 검증 | 2026-02-25 |
| **stub 로 시작** | 첫 Red는 "Not implemented" stub 반환으로 시작. 구현은 /green에서 | 2026-02-25 |

## 2. 알려진 함정

| 함정 | 결과 | 대응 |
|------|------|------|
| **DOM 직접 검증** | `document.querySelector`로 UI 검증 → OS Hook 미사용 → /audit에서 🔴 | OS useComputed/상태 변화로 검증 |
| **구현 포함** | Red 단계에서 실제 동작하는 코드 작성 → TDD 사이클 파괴 | stub만. 구현은 /green |
| **상태 public 노출** | 내부 상태를 직접 검증하지 말고, 공개 API(함수 반환값)만 검증 | 캡슐화 유지 |

## 3. 판정 선례

| 선례 | 결정 | 이유 | 날짜 |
|------|------|------|------|
| locale-switcher.test.ts | DT #1,#2,#4 → 3개 테스트. OS 순수함수 검증 | 키보드(#5-#7)는 OS Zone 미구현으로 보류 | 2026-02-25 |

---

## 갱신 방법
`/red` 세션 종료 후 새 테스트 패턴/함정 발견 시 추가.
