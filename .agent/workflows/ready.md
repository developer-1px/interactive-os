---
description: 개발 환경(App 서버 5555, Docs 서버 4444)이 정상 동작하는지 확인하고, 아니면 복구한다.
---

// turbo-all

## /ready — 개발 환경 준비 보장

> **원칙**: 진단만 하지 않는다. 복구까지 한다.
> `/ready` 호출 후 반환되면, 환경이 정상이라고 신뢰할 수 있어야 한다.

### 대상 서버

| 서버 | 포트 | 용도 | 시작 명령 |
|------|------|------|----------|
| App  | 5555 | 메인 앱 (Vite + TanStack Router) | `npx vite` |
| Docs | 4444 | 문서 뷰어 (Vite + docs.html) | `npx vite --config vite.docs.config.ts` |

### 절차

1. **좀비 프로세스 정리**
   - 각 포트(5555, 4444)에 대해 health check:
     ```
     curl -s --connect-timeout 3 --max-time 5 -o /dev/null -w "%{http_code}" http://localhost:{PORT}/
     ```
   - 200이면 → 해당 서버 정상. 다음 포트로.
   - 연결은 되지만 응답 없음(타임아웃) → 좀비. `lsof -t -i :{PORT} | xargs kill -9`
   - 연결 거부 → 서버 없음. 3단계에서 기동.

2. **Vite 캐시 확인**
   - 좀비가 발견됐거나 서버를 새로 시작해야 하면:
     ```
     rm -rf node_modules/.vite
     ```
   - 이미 두 서버 모두 정상이면 캐시를 건드리지 않는다.

3. **서버 기동**
   - 정상이 아닌 서버만 개별 시작한다.
   - App 서버가 없으면: `npx vite &` (백그라운드)
   - Docs 서버가 없으면: `npx vite --config vite.docs.config.ts &` (백그라운드)
   - 각 서버가 200 응답할 때까지 재시도 (최대 15초).

4. **최종 검증**
   - 두 서버 모두 200 응답 확인.
   - 하나라도 실패하면 에러를 보고하고 멈춘다.

5. **결과 보고**
   ```
   | 서버 | 포트 | 상태 |
   |------|------|------|
   | App  | 5555 | ✅   |
   | Docs | 4444 | ✅   |
   ```

### 호출 관계

이 워크플로우를 호출하는 곳:
- `/verify` — Step 0으로 호출 (E2E 전제조건)
- 독립 실행 — 작업 시작 전 수동 호출
