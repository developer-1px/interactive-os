---
description: 프로젝트의 진실의 원천(Single Source of Truth for WHAT). 기능 요구사항, 상태, 엣지 케이스를 정의한다. 테스트와 코드는 이 문서에서 파생된다.
---

## Why — 이 workflow가 존재하는 이유

> 소스 코드는 "지금 무엇이 있는가(What IS)"를 말하지만, "무엇이어야 하는가(What SHOULD BE)"는 말하지 않는다.
> PRD가 없으면 버그와 의도를 구분할 기준이 없다.
> AI 협업에서 PRD가 모호하면, AI가 빈칸을 가정으로 채우고 그 가정은 리뷰되지 않는 유령 요구사항이 된다.
> **PRD → Test → Code.** 테스트가 코드에서 파생되면 순환 논증이다. PRD에서 파생되어야 한다.

> **분류**: 리프. 다른 워크플로우를 호출하지 않는다.

## 원칙

- PRD는 **프로젝트의 진실의 원천**이다. 코드가 PRD와 다르면 코드가 틀린 것이다.
- 테스트는 PRD의 시나리오를 번역한다.
- 코드 리뷰는 코드가 PRD 시나리오를 충족하는지 검증한다.
- 버그는 "PRD 대비 이탈(deviation from PRD)"로 정의된다.

## 저장 위치

- `docs/1-project/[프로젝트명]/prd.md`
- 프로젝트당 **1파일**. 진실의 원천은 분산하지 않는다.
- Living document — 요구사항이 변경되면 PRD를 **먼저** 갱신하고, 그다음 테스트와 코드를 맞춘다.

## 절차

### Step 1: 기능 목록 추출

- README.md의 Goals/Scope에서 핵심 기능을 추출한다.
- BOARD.md의 Now 태스크가 있으면 참조한다.
- Discussion의 결론이 있으면 참조한다.

### Step 2: PRD 본문 작성

아래 구조로 작성한다. 각 기능은 **Story → Use Case → BDD Scenarios** 순서로 추상에서 구체로 내려간다.

```markdown
# PRD — [프로젝트명]

> 한 줄 요약: [이 프로젝트가 만드는 것]

## 1. 기능 요구사항 (Functional Requirements)

### 1.1 [기능명]

**Story**: [역할]로서, [기능]을 원한다. 그래야 [가치]이기 때문이다.

**Use Case — 주 흐름:**
1. [사용자/시스템 행동]
2. [사용자/시스템 행동]
3. [결과]

**Use Case — 대안 흐름:**
- 2a. [대안 조건] → [대안 결과]
- 2b. [대안 조건] → [대안 결과]

**Scenarios (Given/When/Then):**

Scenario: [시나리오명]
  Given [전제 조건]
    And [추가 전제 조건]
  When [사용자 행동]
  Then [기대 결과]
    And [추가 기대 결과]

Scenario: [엣지 케이스 시나리오명]
  Given [특수한 전제 조건]
  When [사용자 행동]
  Then [기대 결과]

### 1.2 [기능명]
...

## 2. 상태 인벤토리 (State Inventory)

| 상태 | 설명 | 진입 조건 | 탈출 조건 |
|------|------|----------|----------|
| [상태명] | [설명] | [어떻게 이 상태가 되는가] | [어떻게 다음 상태로 넘어가는가] |

## 3. 비기능 요구사항 (Non-Functional Requirements)

해당 사항이 없으면 이 섹션을 생략한다.

- **성능**: [응답 시간, 렌더링 제약 등]
- **접근성**: [키보드 네비게이션, 스크린 리더 등]
- **호환성**: [브라우저, 디바이스 범위 등]

## 4. 범위 밖 (Out of Scope)

명시적으로 이번에 **하지 않는 것**을 나열한다.

- [하지 않는 것 1]
- [하지 않는 것 2]
```

### Step 3: BDD Scenario 작성 원칙

Given/When/Then은 다음 기준을 만족해야 한다:

- **Given = 전제 조건을 명시적으로 강제한다.** 이것이 BDD의 핵심 가치다. "기존 클립보드에 뭐가 있었는가", "현재 선택 상태가 뭔가" — 전제를 빠뜨리면 요구사항이 빠진다.
- **When = 단일 행동.** 하나의 Scenario에서 When은 1개의 행동만 기술한다.
- **Then = 목적 기반 검증.** 수단(dispatch가 N번 되는가)이 아니라 목적(N개가 실제로 붙여지는가)을 검증한다.
- **테스트 가능**: 각 Scenario를 그대로 테스트 케이스로 번역할 수 있어야 한다.
- **독립적**: 각 Scenario는 다른 Scenario와 독립적으로 검증 가능해야 한다.
- **엣지 케이스도 Scenario로**: 별도 섹션으로 분리하지 않고, 해당 기능의 Scenario에 포함한다. 경계 조건, 에러 시나리오, 빈 상태 모두 Given으로 표현.

### Step 4: 자가 검증

PRD 작성 후, **코드를 쓰기 전에** 자가 검증한다.

1. **발산 검증**
   - "이 PRD에서 빠진 시나리오는? 사용자가 예상 밖으로 사용할 수 있는 경우는?"
   - 공격적으로 누락된 Scenario, 빠진 Given 전제, 미처 생각 못한 대안 흐름을 찾는다.
   - 발견된 항목을 PRD에 추가한다.

2. **수렴 검증** (새 발견 0건까지 반복)
   - 체크리스트:
     - [ ] 모든 기능에 Story + Use Case + Scenarios가 있는가?
     - [ ] 모든 Scenario의 Given에 전제 조건이 빠짐없이 명시되었는가?
     - [ ] 대안 흐름(에러, 빈 상태, 경계 조건)이 Scenario로 커버되었는가?
     - [ ] 상태 인벤토리에 빠진 상태가 없는가?
     - [ ] 각 상태의 진입/탈출 조건이 명확한가?
     - [ ] Out of Scope가 명시되었는가?
     - [ ] Scenario가 코드 수준이 아니라 사용자 목적 수준인가?

### Step 5: 사용자 승인

- 검증이 완료된 PRD를 사용자에게 제시한다.
- ✅ 승인 → BOARD.md 태스크를 PRD 기준으로 정렬, 다음 단계로 진행.
- ❌ 수정 요청 → Step 2로 돌아가 반영.

## 규모별 스케일

| 규모 | 필수 섹션 | 선택 섹션 |
|------|----------|----------|
| **Heavy** | Story + Use Case + BDD Scenarios + 상태 인벤토리 + Out of Scope | 비기능 요구사항 |
| **Light** | Story + BDD Scenarios | Use Case, 상태 인벤토리, 비기능, Out of Scope |

Light 트랙이라도 **Story와 BDD Scenarios는 필수**다. Given이 없으면 전제 조건이 빠지고, 전제 조건이 빠지면 요구사항이 빠진다.

## PRD 갱신 규칙

PRD는 living document다. 요구사항이 변경되면:

1. **PRD를 먼저 갱신**한다. 코드를 먼저 고치지 않는다.
2. 변경된 AC에 대응하는 **테스트를 갱신**한다.
3. 테스트가 실패하면 **코드를 수정**한다.
4. 변경 사유를 PRD 하단의 변경 이력에 기록한다.

```markdown
## 변경 이력

| 날짜 | 변경 내용 | 사유 |
|------|----------|------|
| YYYY-MM-DD | AC 1.3 추가 — 빈 선택 시 복사 무시 | 엣지 케이스 발견 |
```
